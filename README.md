# Atom ECO
API для системы учета отходов атом эко.
Разработано по техническому заданию https://github.com/notafavor/test-cases/blob/main/case_1.md

## Описание


Приложение написано на Python с использованием фреймворка FastAPI

### Структура
Основные сущности:
- Отходы (waste) - отходы, учитываемые в системе
- Организация (company) - генерирует отходы
- Хранилище (storage) - принимает отходы от организаций
- Локация (location) - место расположения организации или хранилища
- Дорога (road) - соединяет локации

### Особенности
- Виды отходов, генерируемые организациями и принимаемые хранилищами, могут варьироваться
- Количество соответствующего вида отхода ограничено неким индивидуальным максимальным значением. При этом количество отходов организации не может быть уменьшено без разгрузки в хранилище (обратное справедливо для хранилищ)
- Одна локация может быть привязана либо к одной организации, либо к одному хранилищу
- В приложении эмулируется подключение к гипотетической внешней базе данных локаций/дорог (fake_db в коде). При привязывании некой локации к организации/хранилищу проверяется ее существование в fake_db, и если такая локация существует, то она добавляется в базу данных приложения (db в коде) вместе с соответствующими дорогами. Таким образом в базе данных хранятся только привязанные локации/дороги.
Сеть локаций/дорог генерируется скриптом fake_db.py
- Организация может получить информацию по любому хранилищу, к которому есть доступ (через сеть дорог), в том числе - кратчайшее расстояние и объем.
- Реализована возможность получения оптимального маршрута и выгрузка как для всех видов отходов, так и для отдельного вида. При этом для отдельного вида отходов реализована частичная выгрузка вдоль кратчайшего маршрута (например при необходимости разгрузить 10 единиц может быть выполнена выгрузка в хранилище_1 4 единиц, в хранилище_2 еще 4 единиц, в хранилище_3 оставшиеся 2). Маршрут не может проходить через локации, привязанные к другим организациям, возвращаться назад и создавать петли
- Аутентификация осуществляется по логину (email) и паролю. Авторизация по токену
- Документация Swagger автоматически сгенерирована и сгруппирована по правам доступа
- В приложении не реализованы миграции и логирование

## Запуск

### Системные требования
- ОС Linux
- установленный Docker engine

### Установка и запуск
- скачать файлы репозитория
- создать в корневой папке проекта файл .env (для референса см. файл .env_template)
- запуск командой: ```sudo docker compose up -d --build```
- перейти по адресу localhost:8000/docs
- остановка командой: ```sudo docker compose down```

## Использование
- При первом запуске создается учетная запись администратора системы (логин/пароль см файл .env)
- Получение токена доступа
- Администратором:
    - Создаются виды отходов, учитываемые в системе
    - Создаются организации/хранилища
    - Привязываются виды отходов
    - Привязываются локации
- После этого организации/хранилища могут залогиниться и выполнять операции с отходами

### Тестирование
- войти в cli контейнера: ```sudo docker exec -it atom_eco_app bash```
- тесты запускаются командой: ```pytest -v```

## Разработчики
+ Головин Андрей - [fine-line](https://github.com/fine-line)

## Лицензия
Данный проект имеет лицензию MIT License - больше информации в файле [LICENSE.md](LICENSE.md)

